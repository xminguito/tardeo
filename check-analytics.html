<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Analytics Diagnostic</title>
  <style>
    body {
      font-family: monospace;
      padding: 20px;
      background: #1a1a1a;
      color: #fff;
    }
    .result {
      margin: 10px 0;
      padding: 10px;
      border-radius: 4px;
    }
    .success { background: #065f46; }
    .error { background: #991b1b; }
    .warning { background: #92400e; }
    button {
      padding: 10px 20px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover { background: #2563eb; }
  </style>
</head>
<body>
  <h1>üîç Mixpanel Analytics Diagnostic</h1>
  
  <div id="results"></div>
  
  <button onclick="runDiagnostic()">Run Diagnostic</button>
  
  <script>
    function addResult(message, type = 'info') {
      const div = document.createElement('div');
      div.className = `result ${type}`;
      div.textContent = message;
      document.getElementById('results').appendChild(div);
    }
    
    function runDiagnostic() {
      document.getElementById('results').innerHTML = '';
      
      addResult('üîç Starting diagnostic...', 'info');
      
      // Check environment
      const isDev = window.location.hostname === 'localhost';
      addResult(`üìç Environment: ${isDev ? 'Development (localhost)' : 'Production'}`, 'info');
      
      // Check token (this won't work in this standalone HTML, but shows the pattern)
      addResult('‚ö†Ô∏è This is a standalone diagnostic. For real check, open your app and check console.', 'warning');
      
      // Check localStorage
      const optOut = localStorage.getItem('analytics_opt_out');
      if (optOut === 'true') {
        addResult('‚ùå Analytics OPT-OUT is ENABLED. This prevents tracking!', 'error');
        addResult('Fix: Run in console: localStorage.setItem("analytics_opt_out", "false")', 'warning');
      } else {
        addResult('‚úÖ Analytics opt-out is disabled (good)', 'success');
      }
      
      // Check window flag
      if (window.__TARDEO_ANALYTICS_DISABLED__) {
        addResult('‚ùå Global analytics flag is DISABLED', 'error');
        addResult('Fix: Run in console: window.__TARDEO_ANALYTICS_DISABLED__ = false', 'warning');
      } else {
        addResult('‚úÖ Global analytics flag is not disabled (good)', 'success');
      }
      
      addResult('', 'info');
      addResult('üìã Next steps:', 'warning');
      addResult('1. Open your app in a new tab', 'info');
      addResult('2. Open browser console (F12)', 'info');
      addResult('3. Run: console.log("Token:", import.meta.env.VITE_MIXPANEL_TOKEN)', 'info');
      addResult('4. If undefined/REDACTED, add VITE_MIXPANEL_TOKEN to .env.local', 'info');
      addResult('5. Restart: npm run dev', 'info');
    }
  </script>
</body>
</html>

